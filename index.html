<!doctype html>
<head><meta charset="utf-8">
<link rel="stylesheet" href="ecmarkup.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/github.min.css">
<script src="ecmarkup.js"></script>
<title>Decorators</title><script type="application/json" id="menu-search-biblio">[{"type":"clause","id":"sec-intro","aoid":null,"title":"Introduction","number":"","namespace":"<no location>","location":"","key":"Introduction"},{"type":"clause","id":"sec-intro-syntax","aoid":null,"title":"Syntax","number":"","namespace":"<no location>","location":"","key":"Syntax"},{"type":"clause","id":"sec-intro-decorator-functions","aoid":null,"title":"Decorator Functions","number":"","namespace":"<no location>","location":"","key":"Decorator Functions"},{"type":"clause","id":"sec-syntax","aoid":null,"title":"Syntax","number":"1","namespace":"<no location>","location":"","key":"Syntax"},{"type":"clause","id":"sec-new-syntax","aoid":null,"title":"New Productions","number":"1.1","namespace":"<no location>","location":"","key":"New Productions"},{"type":"clause","id":"sec-updated-syntax","aoid":null,"title":"Updated Productions","number":"1.2","namespace":"<no location>","location":"","key":"Updated Productions"},{"type":"clause","id":"sec-semantics","aoid":null,"title":"Semantics","number":"2","namespace":"<no location>","location":"","key":"Semantics"},{"type":"clause","id":"sec-updated-semantics","aoid":null,"title":"Updated Operations","number":"2.1","namespace":"<no location>","location":"","key":"Updated Operations"},{"type":"clause","id":"sec-runtime-semantics-definemethod","aoid":null,"title":"Runtime Semantics: DefineMethod","number":"2.1.1","namespace":"<no location>","location":"","key":"Runtime Semantics: DefineMethod"},{"type":"clause","id":"sec-runtime-semantics-classdefinitionevaluation","aoid":null,"title":"Runtime Semantics: ClassDefinitionEvaluation","number":"2.1.2","namespace":"<no location>","location":"","key":"Runtime Semantics: ClassDefinitionEvaluation"},{"type":"clause","id":"sec-method-definitions-runtime-semantics-propertydefinitionevaluation","aoid":null,"title":"Runtime Semantics: PropertyDefinitionEvaluation","number":"2.1.3","namespace":"<no location>","location":"","key":"Runtime Semantics: PropertyDefinitionEvaluation"},{"type":"clause","id":"sec-new-semantics","aoid":null,"title":"New Operations","number":"2.2","namespace":"<no location>","location":"","key":"New Operations"},{"type":"clause","id":"sec-decorator-runtime-semantics-decoratorevaluation","aoid":null,"title":"Runtime Semantics: DecoratorEvaluation","number":"2.2.1","namespace":"<no location>","location":"","key":"Runtime Semantics: DecoratorEvaluation"},{"type":"clause","id":"sec-method-definitions-runtime-semantics-decoratorlistevaluation","aoid":null,"title":"Runtime Semantics: DecoratorListEvaluation","number":"2.2.2","namespace":"<no location>","location":"","key":"Runtime Semantics: DecoratorListEvaluation"},{"type":"clause","id":"sec-runtime-semantics-makefunctionuninitialized","aoid":null,"title":"Runtime Semantics: MakeFunctionUninitialized","number":"2.2.3","namespace":"<no location>","location":"","key":"Runtime Semantics: MakeFunctionUninitialized"},{"type":"clause","id":"sec-runtime-semantics-makefunctioninitialized","aoid":null,"title":"Runtime Semantics: MakeFunctionInitialized","number":"2.2.4","namespace":"<no location>","location":"","key":"Runtime Semantics: MakeFunctionInitialized"},{"type":"clause","id":"sec-runtime-semantics-makefunctioninitialized","aoid":null,"title":"Runtime Semantics: IsUninitializedFunction","number":"2.2.5","namespace":"<no location>","location":"","key":"Runtime Semantics: IsUninitializedFunction"},{"type":"clause","id":"sec-runtime-semantics-makeclasselementsinitialized","aoid":null,"title":"Runtime Semantics: MakeClassElementsInitialized","number":"2.2.6","namespace":"<no location>","location":"","key":"Runtime Semantics: MakeClassElementsInitialized"},{"type":"op","aoid":"DecorateElement","refId":"sec-decorate-element","location":"","key":"DecorateElement"},{"type":"clause","id":"sec-decorate-element","aoid":"DecorateElement","title":"DecorateElement","number":"2.2.7","namespace":"<no location>","location":"","key":"DecorateElement"},{"type":"clause","id":"sec-decorate-class","aoid":null,"title":"DecorateClass","number":"2.2.8","namespace":"<no location>","location":"","key":"DecorateClass"},{"type":"clause","id":"sec-from-element-descriptor","aoid":null,"title":"FromElementDescriptor","number":"2.2.9","namespace":"<no location>","location":"","key":"FromElementDescriptor"},{"type":"clause","id":"sec-to-element-descriptor","aoid":null,"title":"ToElementDescriptor","number":"2.2.10","namespace":"<no location>","location":"","key":"ToElementDescriptor"},{"type":"clause","id":"sec-copyright-and-software-license","aoid":null,"title":"Copyright & Software License","number":"A","namespace":"<no location>","location":"","key":"Copyright & Software License"},{"type":"production","id":"prod-DecoratorList","name":"DecoratorList","namespace":"<no location>","location":"","key":"DecoratorList"},{"type":"production","id":"prod-Decorator","name":"Decorator","namespace":"<no location>","location":"","key":"Decorator"},{"type":"production","id":"prod-DecoratorMemberExpression","name":"DecoratorMemberExpression","namespace":"<no location>","location":"","key":"DecoratorMemberExpression"},{"type":"production","id":"prod-DecoratorCallExpression","name":"DecoratorCallExpression","namespace":"<no location>","location":"","key":"DecoratorCallExpression"},{"type":"production","id":"prod-PropertyDefinition","name":"PropertyDefinition","namespace":"<no location>","location":"","key":"PropertyDefinition"},{"type":"production","id":"prod-ClassDeclaration","name":"ClassDeclaration","namespace":"<no location>","location":"","key":"ClassDeclaration"},{"type":"production","id":"prod-ClassExpression","name":"ClassExpression","namespace":"<no location>","location":"","key":"ClassExpression"},{"type":"production","id":"prod-ClassElement","name":"ClassElement","namespace":"<no location>","location":"","key":"ClassElement"},{"type":"production","id":"prod-MethodDefinition","name":"MethodDefinition","namespace":"<no location>","location":"","key":"MethodDefinition"},{"type":"production","id":"prod-ClassTail","name":"ClassTail","namespace":"<no location>","location":"","key":"ClassTail"},{"type":"production","id":"prod-FormalParameters","name":"FormalParameters","namespace":"<no location>","location":"","key":"FormalParameters"},{"type":"production","id":"prod-GeneratorMethod","name":"GeneratorMethod","namespace":"<no location>","location":"","key":"GeneratorMethod"},{"type":"term","term":"member decorator function","refId":"sec-intro-decorator-functions","namespace":"<no location>","location":"","key":"member decorator function"},{"type":"term","term":"member descriptor","refId":"sec-intro-decorator-functions","namespace":"<no location>","location":"","key":"member descriptor"},{"type":"term","term":"class decorator function","refId":"sec-intro-decorator-functions","namespace":"<no location>","location":"","key":"class decorator function"}]</script></head><body><div id="menu-toggle">☰</div><div id="menu"><div id="menu-search"><input type="text" id="menu-search-box" placeholder="Search..."><div id="menu-search-results" class="inactive"></div></div><div id="menu-toc"><ol class="toc"><li><span class="item-toggle">◢</span><a href="#sec-intro" title="Introduction"><span class="secnum"></span> Introduction</a><ol class="toc"><li><span class="item-toggle-none"></span><a href="#sec-intro-syntax" title="Syntax"><span class="secnum"></span> Syntax</a></li><li><span class="item-toggle-none"></span><a href="#sec-intro-decorator-functions" title="Decorator Functions"><span class="secnum"></span> Decorator Functions</a></li></ol></li><li><span class="item-toggle">◢</span><a href="#sec-syntax" title="Syntax"><span class="secnum">1</span> Syntax</a><ol class="toc"><li><span class="item-toggle-none"></span><a href="#sec-new-syntax" title="New Productions"><span class="secnum">1.1</span> New Productions</a></li><li><span class="item-toggle-none"></span><a href="#sec-updated-syntax" title="Updated Productions"><span class="secnum">1.2</span> Updated Productions</a></li></ol></li><li><span class="item-toggle">◢</span><a href="#sec-semantics" title="Semantics"><span class="secnum">2</span> Semantics</a><ol class="toc"><li><span class="item-toggle">◢</span><a href="#sec-updated-semantics" title="Updated Operations"><span class="secnum">2.1</span> Updated Operations</a><ol class="toc"><li><span class="item-toggle-none"></span><a href="#sec-runtime-semantics-definemethod" title="Runtime Semantics: DefineMethod"><span class="secnum">2.1.1</span> RS: DefineMethod</a></li><li><span class="item-toggle-none"></span><a href="#sec-runtime-semantics-classdefinitionevaluation" title="Runtime Semantics: ClassDefinitionEvaluation"><span class="secnum">2.1.2</span> RS: ClassDefinitionEvaluation</a></li><li><span class="item-toggle-none"></span><a href="#sec-method-definitions-runtime-semantics-propertydefinitionevaluation" title="Runtime Semantics: PropertyDefinitionEvaluation"><span class="secnum">2.1.3</span> RS: PropertyDefinitionEvaluation</a></li></ol></li><li><span class="item-toggle">◢</span><a href="#sec-new-semantics" title="New Operations"><span class="secnum">2.2</span> New Operations</a><ol class="toc"><li><span class="item-toggle-none"></span><a href="#sec-decorator-runtime-semantics-decoratorevaluation" title="Runtime Semantics: DecoratorEvaluation"><span class="secnum">2.2.1</span> RS: DecoratorEvaluation</a></li><li><span class="item-toggle-none"></span><a href="#sec-method-definitions-runtime-semantics-decoratorlistevaluation" title="Runtime Semantics: DecoratorListEvaluation"><span class="secnum">2.2.2</span> RS: DecoratorListEvaluation</a></li><li><span class="item-toggle-none"></span><a href="#sec-runtime-semantics-makefunctionuninitialized" title="Runtime Semantics: MakeFunctionUninitialized"><span class="secnum">2.2.3</span> RS: MakeFunctionUninitialized</a></li><li><span class="item-toggle-none"></span><a href="#sec-runtime-semantics-makefunctioninitialized" title="Runtime Semantics: MakeFunctionInitialized"><span class="secnum">2.2.4</span> RS: MakeFunctionInitialized</a></li><li><span class="item-toggle-none"></span><a href="#sec-runtime-semantics-makefunctioninitialized" title="Runtime Semantics: IsUninitializedFunction"><span class="secnum">2.2.5</span> RS: IsUninitializedFunction</a></li><li><span class="item-toggle-none"></span><a href="#sec-runtime-semantics-makeclasselementsinitialized" title="Runtime Semantics: MakeClassElementsInitialized"><span class="secnum">2.2.6</span> RS: MakeClassElementsInitialized</a></li><li><span class="item-toggle-none"></span><a href="#sec-decorate-element" title="DecorateElement"><span class="secnum">2.2.7</span> DecorateElement</a></li><li><span class="item-toggle-none"></span><a href="#sec-decorate-class" title="DecorateClass"><span class="secnum">2.2.8</span> DecorateClass</a></li><li><span class="item-toggle-none"></span><a href="#sec-from-element-descriptor" title="FromElementDescriptor"><span class="secnum">2.2.9</span> FromElementDescriptor</a></li><li><span class="item-toggle-none"></span><a href="#sec-to-element-descriptor" title="ToElementDescriptor"><span class="secnum">2.2.10</span> ToElementDescriptor</a></li></ol></li></ol></li><li><span class="item-toggle-none"></span><a href="#sec-copyright-and-software-license" title="Copyright &amp; Software License"><span class="secnum">A</span> Copyright &amp; Software License</a></li></ol></div></div><h1 class="version">Stage 1 Draft / July 18, 2016</h1><h1 class="title">Decorators</h1>
<emu-intro id="sec-intro">
  <h1><span class="secnum"></span>Introduction<span class="utils"><span class="anchor"><a href="#sec-intro">#</a></span></span></h1>
  <p>Decorators offer a convenient declarative syntax to modify the shape of class declarations. This capability can be used for myriad purposes including modifying the descriptor of the declared member (@nonconfigurable/@enumerable), adding metadata (as used by Angular), and more.</p>

  <emu-intro id="sec-intro-syntax">
    <h1><span class="secnum"></span>Syntax<span class="utils"><span class="anchor"><a href="#sec-intro-syntax">#</a></span></span></h1>

    <p>As of this proposal, decorators can be attached to either classes or class members. An example of such a class might be:</p>
    <pre><code class="javascript hljs">@autobind <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Foo</span> </span>{
  @configurable(<span class="hljs-literal">false</span>) @enumerable(<span class="hljs-literal">true</span>) method() {}
}</code></pre>
    <p>Prior to the  <code>class</code> keyword and prior to method definitions are a new  <emu-nt><a href="#prod-DecoratorList">DecoratorList</a></emu-nt> production - essentially, a list of  <emu-nt><a href="#prod-Decorator">Decorator</a></emu-nt> productions. The  <emu-nt><a href="#prod-Decorator">Decorator</a></emu-nt> production is  <code>@</code> followed by a sequence of dotted identifiers (no  <code>[]</code> access is allowed due to grammar difficulties) and an argument list. Thus,  <code>@foo.bar()</code> is valid, while  <code>@foo().bar()</code> is a syntax error.</p>
    <emu-note><span class="note">Note</span>
      <p>The syntax here can be pretty much anything, but this proposal takes a maximally conservative approach. Square brackets can be made unambiguous with a clever cover grammar but the syntax is confusing and error-prone.</p>
    </emu-note>
    <p>Elements of the  <emu-nt><a href="#prod-DecoratorList">DecoratorList</a></emu-nt> are evaluated in-order but their resulting decorator functions are evaluated in a bottom-up fashion. Changes by a previous decorator are visible to subsequent decorators.</p>
  </emu-intro>
  <emu-intro id="sec-intro-decorator-functions">
    <h1><span class="secnum"></span>Decorator Functions<span class="utils"><span class="anchor"><a href="#sec-intro-decorator-functions">#</a></span></span></h1>
    <p>A    <dfn>member decorator function</dfn> is a function which takes a <emu-xref href="#sec-intro-decorator-functions"><a href="#sec-intro-decorator-functions">member descriptor</a></emu-xref> and which returns a <emu-xref href="#sec-intro-decorator-functions"><a href="#sec-intro-decorator-functions">member descriptor</a></emu-xref>. A    <dfn>member descriptor</dfn> is similar to a property descriptor and has the following shape:</p>
    <pre><code class="typescript hljs"><span class="hljs-keyword">interface</span> MemberDesciptor {
  kind: <span class="hljs-string">"Property"</span>
  key: <span class="hljs-built_in">string</span>,
  isStatic: <span class="hljs-built_in">boolean</span>,
  descriptor: PropertyDescriptor,
  extras?: MemberDescriptor[]
}</code></pre>
    <p>A    <dfn>class decorator function</dfn> is a function which takes a constructor, heritage (parent class), and an array of MemberDescriptors that represent the instance and static members of the class.</p>

    <pre><code>
      function configurable(val) {
        return function (member) {
          member.descriptor.configurable = val;
          return member;
        }
      }


      class Foo {
        @configurable(false)
        bar(){};
      }

      Object.defineProperty(Foo.prototype, 'bar', { configurable: false});


      function addMetadata(val) {
        return function ({klass, parent, members}) {
          members.push({
            kind: 'Property',
            key: '__metadata',
            isStatic: true,
            descriptor: {
              value: val
            }
          });

          return { klass, parent, members };
        }
      }

      @addMetadata('hi')
      class Foo {
      }

      Foo.__metadata = 'hi';
    </code></pre>
  </emu-intro>
</emu-intro>

<emu-clause id="sec-syntax">
  <h1><span class="secnum">1</span>Syntax<span class="utils"><span class="anchor"><a href="#sec-syntax">#</a></span></span></h1>

  <emu-clause id="sec-new-syntax">
    <h1><span class="secnum">1.1</span>New Productions<span class="utils"><span class="anchor"><a href="#sec-new-syntax">#</a></span></span></h1>

    <emu-grammar><emu-production name="DecoratorList" params="Yield" id="prod-DecoratorList">
    <emu-nt params="Yield"><a href="#prod-DecoratorList">DecoratorList</a><emu-mods><emu-params>[Yield]</emu-params></emu-mods></emu-nt><emu-geq>:</emu-geq><emu-rhs a="1bdc63ed"><emu-nt params="?Yield" optional=""><a href="#prod-DecoratorList">DecoratorList</a><emu-mods><emu-params>[?Yield]</emu-params><emu-opt>opt</emu-opt></emu-mods></emu-nt><emu-nt params="?Yield"><a href="#prod-Decorator">Decorator</a><emu-mods><emu-params>[?Yield]</emu-params></emu-mods></emu-nt></emu-rhs>
</emu-production>
<emu-production name="Decorator" params="Yield" id="prod-Decorator">
    <emu-nt params="Yield"><a href="#prod-Decorator">Decorator</a><emu-mods><emu-params>[Yield]</emu-params></emu-mods></emu-nt><emu-geq>:</emu-geq><emu-rhs a="16b21563"><emu-t>@</emu-t><emu-nt params="?Yield"><a href="#prod-DecoratorMemberExpression">DecoratorMemberExpression</a><emu-mods><emu-params>[?Yield]</emu-params></emu-mods></emu-nt></emu-rhs>
    <emu-rhs a="c70b83ce"><emu-t>@</emu-t><emu-nt params="?Yield"><a href="#prod-DecoratorCallExpression">DecoratorCallExpression</a><emu-mods><emu-params>[?Yield]</emu-params></emu-mods></emu-nt></emu-rhs>
</emu-production>
<emu-production name="DecoratorMemberExpression" params="Yield" id="prod-DecoratorMemberExpression">
    <emu-nt params="Yield"><a href="#prod-DecoratorMemberExpression">DecoratorMemberExpression</a><emu-mods><emu-params>[Yield]</emu-params></emu-mods></emu-nt><emu-geq>:</emu-geq><emu-rhs a="3a0131bb"><emu-nt params="?Yield"><a href="https://tc39.github.io/ecma262/#prod-IdentifierReference">IdentifierReference</a><emu-mods><emu-params>[?Yield]</emu-params></emu-mods></emu-nt></emu-rhs>
    <emu-rhs a="58cc4a67"><emu-nt params="?Yield"><a href="#prod-DecoratorMemberExpression">DecoratorMemberExpression</a><emu-mods><emu-params>[?Yield]</emu-params></emu-mods></emu-nt><emu-t>.</emu-t><emu-nt><a href="https://tc39.github.io/ecma262/#prod-IdentifierName">IdentifierName</a></emu-nt></emu-rhs>
</emu-production>
<emu-production name="DecoratorCallExpression" params="Yield" id="prod-DecoratorCallExpression">
    <emu-nt params="Yield"><a href="#prod-DecoratorCallExpression">DecoratorCallExpression</a><emu-mods><emu-params>[Yield]</emu-params></emu-mods></emu-nt><emu-geq>:</emu-geq><emu-rhs a="25e493a4"><emu-nt><a href="#prod-DecoratorMemberExpression">DecoratorMemberExpression</a></emu-nt><emu-nt params="?Yield"><a href="https://tc39.github.io/ecma262/#prod-Arguments">Arguments</a><emu-mods><emu-params>[?Yield]</emu-params></emu-mods></emu-nt></emu-rhs>
</emu-production></emu-grammar>
  </emu-clause>

  <emu-clause id="sec-updated-syntax">
    <h1><span class="secnum">1.2</span>Updated Productions<span class="utils"><span class="anchor"><a href="#sec-updated-syntax">#</a></span></span></h1>

    <p><emu-grammar><emu-production name="PropertyDefinition" collapsed="" id="prod-PropertyDefinition" class=" inline">
    <emu-nt><a href="#prod-PropertyDefinition">PropertyDefinition</a></emu-nt><emu-geq>:</emu-geq><emu-rhs a="4bc22514"><emu-nt><a href="#prod-MethodDefinition">MethodDefinition</a></emu-nt></emu-rhs>
</emu-production></emu-grammar> gets an optional <emu-nt><a href="#prod-DecoratorList">DecoratorList</a></emu-nt>.</p>
    <emu-grammar><emu-production name="PropertyDefinition" params="Yield">
    <emu-nt params="Yield"><a href="#prod-PropertyDefinition">PropertyDefinition</a><emu-mods><emu-params>[Yield]</emu-params></emu-mods></emu-nt><emu-geq>:</emu-geq><emu-rhs a="3a0131bb"><emu-nt params="?Yield"><a href="https://tc39.github.io/ecma262/#prod-IdentifierReference">IdentifierReference</a><emu-mods><emu-params>[?Yield]</emu-params></emu-mods></emu-nt></emu-rhs>
    <emu-rhs a="024b5337"><emu-nt params="?Yield"><a href="https://tc39.github.io/ecma262/#prod-CoverInitializedName">CoverInitializedName</a><emu-mods><emu-params>[?Yield]</emu-params></emu-mods></emu-nt></emu-rhs>
    <emu-rhs a="8aec5117"><emu-nt params="?Yield"><a href="https://tc39.github.io/ecma262/#prod-PropertyName">PropertyName</a><emu-mods><emu-params>[?Yield]</emu-params></emu-mods></emu-nt><emu-t>:</emu-t><emu-nt params="+In, ?Yield"><a href="https://tc39.github.io/ecma262/#prod-AssignmentExpression">AssignmentExpression</a><emu-mods><emu-params>[+In, ?Yield]</emu-params></emu-mods></emu-nt></emu-rhs>
    <emu-rhs a="d7587579"><emu-nt params="?Yield" optional=""><a href="#prod-DecoratorList">DecoratorList</a><emu-mods><emu-params>[?Yield]</emu-params><emu-opt>opt</emu-opt></emu-mods></emu-nt><emu-nt params="?Yield"><a href="#prod-MethodDefinition">MethodDefinition</a><emu-mods><emu-params>[?Yield]</emu-params></emu-mods></emu-nt></emu-rhs>
</emu-production></emu-grammar>

    <p><emu-grammar><emu-production name="ClassDeclaration" collapsed="" id="prod-ClassDeclaration" class=" inline">
    <emu-nt><a href="#prod-ClassDeclaration">ClassDeclaration</a></emu-nt><emu-geq>:</emu-geq><emu-rhs a="4ee4ae5a"><emu-t>class</emu-t><emu-nt><a href="https://tc39.github.io/ecma262/#prod-BindingIdentifier">BindingIdentifier</a></emu-nt><emu-nt><a href="#prod-ClassTail">ClassTail</a></emu-nt></emu-rhs>
</emu-production></emu-grammar> and  <emu-grammar><emu-production name="ClassDeclaration" collapsed="" class=" inline">
    <emu-nt><a href="#prod-ClassDeclaration">ClassDeclaration</a></emu-nt><emu-geq>:</emu-geq><emu-rhs a="f204dc08" constraints="+Default"><emu-constraints>[+Default]</emu-constraints><emu-t>class</emu-t><emu-nt><a href="#prod-ClassTail">ClassTail</a></emu-nt></emu-rhs>
</emu-production></emu-grammar> get an optional <emu-nt><a href="#prod-DecoratorList">DecoratorList</a></emu-nt>.</p>
    <emu-grammar><emu-production name="ClassDeclaration" params="Yield, Default">
    <emu-nt params="Yield, Default"><a href="#prod-ClassDeclaration">ClassDeclaration</a><emu-mods><emu-params>[Yield, Default]</emu-params></emu-mods></emu-nt><emu-geq>:</emu-geq><emu-rhs a="75e2b2b0"><emu-nt params="?Yield" optional=""><a href="#prod-DecoratorList">DecoratorList</a><emu-mods><emu-params>[?Yield]</emu-params><emu-opt>opt</emu-opt></emu-mods></emu-nt><emu-t>class</emu-t><emu-nt params="?Yield"><a href="https://tc39.github.io/ecma262/#prod-BindingIdentifier">BindingIdentifier</a><emu-mods><emu-params>[?Yield]</emu-params></emu-mods></emu-nt><emu-nt params="?Yield"><a href="#prod-ClassTail">ClassTail</a><emu-mods><emu-params>[?Yield]</emu-params></emu-mods></emu-nt></emu-rhs>
    <emu-rhs a="f4395bdf" constraints="+Default"><emu-constraints>[+Default]</emu-constraints><emu-nt params="?Yield" optional=""><a href="#prod-DecoratorList">DecoratorList</a><emu-mods><emu-params>[?Yield]</emu-params><emu-opt>opt</emu-opt></emu-mods></emu-nt><emu-t>class</emu-t><emu-nt params="?Yield"><a href="#prod-ClassTail">ClassTail</a><emu-mods><emu-params>[?Yield]</emu-params></emu-mods></emu-nt></emu-rhs>
</emu-production></emu-grammar>

    <p><emu-grammar><emu-production name="ClassExpression" collapsed="" id="prod-ClassExpression" class=" inline">
    <emu-nt><a href="#prod-ClassExpression">ClassExpression</a></emu-nt><emu-geq>:</emu-geq><emu-rhs a="d022e28b"><emu-t>class</emu-t><emu-nt optional=""><a href="https://tc39.github.io/ecma262/#prod-BindingIdentifier">BindingIdentifier</a><emu-mods><emu-opt>opt</emu-opt></emu-mods></emu-nt><emu-nt><a href="#prod-ClassTail">ClassTail</a></emu-nt></emu-rhs>
</emu-production></emu-grammar> gets an optional <emu-nt><a href="#prod-DecoratorList">DecoratorList</a></emu-nt>.</p>
    <emu-grammar><emu-production name="ClassExpression" params="Yield">
    <emu-nt params="Yield"><a href="#prod-ClassExpression">ClassExpression</a><emu-mods><emu-params>[Yield]</emu-params></emu-mods></emu-nt><emu-geq>:</emu-geq><emu-rhs a="c38a456b"><emu-nt params="?Yield" optional=""><a href="#prod-DecoratorList">DecoratorList</a><emu-mods><emu-params>[?Yield]</emu-params><emu-opt>opt</emu-opt></emu-mods></emu-nt><emu-t>class</emu-t><emu-nt params="?Yield" optional=""><a href="https://tc39.github.io/ecma262/#prod-BindingIdentifier">BindingIdentifier</a><emu-mods><emu-params>[?Yield]</emu-params><emu-opt>opt</emu-opt></emu-mods></emu-nt><emu-nt params="?Yield"><a href="#prod-ClassTail">ClassTail</a><emu-mods><emu-params>[?Yield]</emu-params></emu-mods></emu-nt></emu-rhs>
</emu-production></emu-grammar>

    <p><emu-grammar><emu-production name="ClassElement" collapsed="" id="prod-ClassElement" class=" inline">
    <emu-nt><a href="#prod-ClassElement">ClassElement</a></emu-nt><emu-geq>:</emu-geq><emu-rhs a="4bc22514"><emu-nt><a href="#prod-MethodDefinition">MethodDefinition</a></emu-nt></emu-rhs>
</emu-production></emu-grammar> and  <emu-grammar><emu-production name="ClassElement" collapsed="" class=" inline">
    <emu-nt><a href="#prod-ClassElement">ClassElement</a></emu-nt><emu-geq>:</emu-geq><emu-rhs a="fa58c6b5"><emu-t>static</emu-t><emu-nt><a href="#prod-MethodDefinition">MethodDefinition</a></emu-nt></emu-rhs>
</emu-production></emu-grammar> gets an optional <emu-nt><a href="#prod-DecoratorList">DecoratorList</a></emu-nt>.</p>
    <emu-grammar><emu-production name="ClassElement" params="Yield">
    <emu-nt params="Yield"><a href="#prod-ClassElement">ClassElement</a><emu-mods><emu-params>[Yield]</emu-params></emu-mods></emu-nt><emu-geq>:</emu-geq><emu-rhs a="d7587579"><emu-nt params="?Yield" optional=""><a href="#prod-DecoratorList">DecoratorList</a><emu-mods><emu-params>[?Yield]</emu-params><emu-opt>opt</emu-opt></emu-mods></emu-nt><emu-nt params="?Yield"><a href="#prod-MethodDefinition">MethodDefinition</a><emu-mods><emu-params>[?Yield]</emu-params></emu-mods></emu-nt></emu-rhs>
    <emu-rhs a="26cbd7b0"><emu-nt params="?Yield" optional=""><a href="#prod-DecoratorList">DecoratorList</a><emu-mods><emu-params>[?Yield]</emu-params><emu-opt>opt</emu-opt></emu-mods></emu-nt><emu-t>static</emu-t><emu-nt params="?Yield"><a href="#prod-MethodDefinition">MethodDefinition</a><emu-mods><emu-params>[?Yield]</emu-params></emu-mods></emu-nt></emu-rhs>
</emu-production></emu-grammar>
  </emu-clause>
</emu-clause>

<emu-clause id="sec-semantics">
  <h1><span class="secnum">2</span>Semantics<span class="utils"><span class="anchor"><a href="#sec-semantics">#</a></span></span></h1>

  <emu-clause id="sec-updated-semantics">
    <h1><span class="secnum">2.1</span>Updated Operations<span class="utils"><span class="anchor"><a href="#sec-updated-semantics">#</a></span></span></h1>

    <emu-clause id="sec-runtime-semantics-definemethod">
      <h1><span class="secnum">2.1.1</span>Runtime Semantics: DefineMethod<span class="utils"><span class="anchor"><a href="#sec-runtime-semantics-definemethod">#</a></span></span></h1>
      <p>With  <del>parameters <var>object</var> and</del> optional parameter <var>functionPrototype</var>.</p>
      <emu-grammar><emu-production name="MethodDefinition" collapsed="" id="prod-MethodDefinition">
    <emu-nt><a href="#prod-MethodDefinition">MethodDefinition</a></emu-nt><emu-geq>:</emu-geq><emu-rhs a="127f1e91"><emu-nt><a href="https://tc39.github.io/ecma262/#prod-PropertyName">PropertyName</a></emu-nt><emu-t>(</emu-t><emu-nt><a href="https://tc39.github.io/ecma262/#prod-StrictFormalParameters">StrictFormalParameters</a></emu-nt><emu-t>)</emu-t><emu-t>{</emu-t><emu-nt><a href="https://tc39.github.io/ecma262/#prod-FunctionBody">FunctionBody</a></emu-nt><emu-t>}</emu-t></emu-rhs>
</emu-production></emu-grammar>
      <emu-alg><ol><li>Let <var>propKey</var> be the result of evaluating <emu-nt><a href="https://tc39.github.io/ecma262/#prod-PropertyName">PropertyName</a></emu-nt>.</li><li><emu-xref aoid="ReturnIfAbrupt"><a href="https://tc39.github.io/ecma262/#sec-returnifabrupt">ReturnIfAbrupt</a></emu-xref>(<var>propKey</var>).</li><li>If the function code for this <emu-nt><a href="#prod-MethodDefinition">MethodDefinition</a></emu-nt> is <emu-xref href="#sec-strict-mode-code"><a href="https://tc39.github.io/ecma262/#sec-strict-mode-code">strict mode code</a></emu-xref>, let <var>strict</var> be <emu-val>true</emu-val>. Otherwise let <var>strict</var> be <emu-val>false</emu-val>.</li><li>Let <var>scope</var> be the <emu-xref href="#running-execution-context"><a href="https://tc39.github.io/ecma262/#running-execution-context">running execution context</a></emu-xref>'s LexicalEnvironment.</li><li>If <var>functionPrototype</var> was passed as a parameter, let <var>kind</var> be <emu-const>Normal</emu-const>; otherwise let <var>kind</var> be <emu-const>Method</emu-const>.</li><li>Let <var>closure</var> be <emu-xref aoid="FunctionCreate"><a href="https://tc39.github.io/ecma262/#sec-functioncreate">FunctionCreate</a></emu-xref>(<var>kind</var>, <emu-nt><a href="https://tc39.github.io/ecma262/#prod-StrictFormalParameters">StrictFormalParameters</a></emu-nt>, <emu-nt><a href="https://tc39.github.io/ecma262/#prod-FunctionBody">FunctionBody</a></emu-nt>, <var>scope</var>, <var>strict</var>). If <var>functionPrototype</var> was passed as a parameter, then pass its value as the <var>prototype</var> optional argument of <emu-xref aoid="FunctionCreate"><a href="https://tc39.github.io/ecma262/#sec-functioncreate">FunctionCreate</a></emu-xref>.</li><li><del>Perform <emu-xref aoid="MakeMethod"><a href="https://tc39.github.io/ecma262/#sec-makemethod">MakeMethod</a></emu-xref>(<var>closure</var>, <var>object</var>).</del></li><li><del>Return the <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.github.io/ecma262/#sec-list-and-record-specification-type">Record</a></emu-xref>{[[Key]]: <var>propKey</var>, [[Closure]]: <var>closure</var>}.</del></li><li><ins>Let <var>desc</var> be the PropertyDescriptor{[[Value]]: <var>closure</var>, [[Writable]]: <emu-val>true</emu-val>, [[Enumerable]]: <var>enumerable</var>, [[Configurable]]: <emu-val>true</emu-val>}.</ins></li><li><ins>Return the <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.github.io/ecma262/#sec-list-and-record-specification-type">Record</a></emu-xref>{[[Key]]: <var>propKey</var>, [[Descriptor]]: <var>desc</var>}.</ins>
      </li></ol></emu-alg>
    </emu-clause>

    <emu-clause id="sec-runtime-semantics-classdefinitionevaluation">
      <h1><span class="secnum">2.1.2</span>Runtime Semantics: ClassDefinitionEvaluation<span class="utils"><span class="anchor"><a href="#sec-runtime-semantics-classdefinitionevaluation">#</a></span></span></h1>
      <p>With parameter <var>className</var>.</p>
      <emu-grammar><emu-production name="ClassTail" collapsed="" id="prod-ClassTail">
    <emu-nt><a href="#prod-ClassTail">ClassTail</a></emu-nt><emu-geq>:</emu-geq><emu-rhs a="b8ea6aa5"><emu-nt optional=""><a href="https://tc39.github.io/ecma262/#prod-ClassHeritage">ClassHeritage</a><emu-mods><emu-opt>opt</emu-opt></emu-mods></emu-nt><emu-t>{</emu-t><emu-nt optional=""><a href="https://tc39.github.io/ecma262/#prod-ClassBody">ClassBody</a><emu-mods><emu-opt>opt</emu-opt></emu-mods></emu-nt><emu-t>}</emu-t></emu-rhs>
</emu-production></emu-grammar>
      <emu-alg><ol><li>Let <var>lex</var> be the LexicalEnvironment of the <emu-xref href="#running-execution-context"><a href="https://tc39.github.io/ecma262/#running-execution-context">running execution context</a></emu-xref>.</li><li>Let <var>classScope</var> be <emu-xref aoid="NewDeclarativeEnvironment"><a href="https://tc39.github.io/ecma262/#sec-newdeclarativeenvironment">NewDeclarativeEnvironment</a></emu-xref>(<var>lex</var>).</li><li>Let <var>classScopeEnvRec</var> be <var>classScope</var>'s <emu-xref href="#sec-lexical-environments"><a href="https://tc39.github.io/ecma262/#sec-lexical-environments">EnvironmentRecord</a></emu-xref>.</li><li>If <var>className</var> is not <emu-val>undefined</emu-val>, then<ol><li>Perform <var>classScopeEnvRec</var>.CreateImmutableBinding(<var>className</var>, <emu-val>true</emu-val>).</li></ol></li><li>If <emu-nt optional=""><a href="https://tc39.github.io/ecma262/#prod-ClassHeritage">ClassHeritage</a><emu-mods><emu-opt>opt</emu-opt></emu-mods></emu-nt> is not present, then<ol><li>Let <var>protoParent</var> be the intrinsic object <emu-xref href="#sec-properties-of-the-object-prototype-object"><a href="https://tc39.github.io/ecma262/#sec-properties-of-the-object-prototype-object">%ObjectPrototype%</a></emu-xref>.</li><li>Let <var>constructorParent</var> be the intrinsic object <emu-xref href="#sec-properties-of-the-function-constructor"><a href="https://tc39.github.io/ecma262/#sec-properties-of-the-function-constructor">%FunctionPrototype%</a></emu-xref>.</li></ol></li><li>Else,<ol><li>Set the <emu-xref href="#running-execution-context"><a href="https://tc39.github.io/ecma262/#running-execution-context">running execution context</a></emu-xref>'s LexicalEnvironment to <var>classScope</var>.</li><li>Let <var>superclass</var> be the result of evaluating <emu-nt><a href="https://tc39.github.io/ecma262/#prod-ClassHeritage">ClassHeritage</a></emu-nt>.</li><li>Set the <emu-xref href="#running-execution-context"><a href="https://tc39.github.io/ecma262/#running-execution-context">running execution context</a></emu-xref>'s LexicalEnvironment to <var>lex</var>.</li><li><emu-xref aoid="ReturnIfAbrupt"><a href="https://tc39.github.io/ecma262/#sec-returnifabrupt">ReturnIfAbrupt</a></emu-xref>(<var>superclass</var>).</li><li>If <var>superclass</var> is <emu-val>null</emu-val>, then<ol><li>Let <var>protoParent</var> be <emu-val>null</emu-val>.</li><li>Let <var>constructorParent</var> be the intrinsic object <emu-xref href="#sec-properties-of-the-function-constructor"><a href="https://tc39.github.io/ecma262/#sec-properties-of-the-function-constructor">%FunctionPrototype%</a></emu-xref>.</li></ol></li><li>Else if <emu-xref aoid="IsConstructor"><a href="https://tc39.github.io/ecma262/#sec-isconstructor">IsConstructor</a></emu-xref>(<var>superclass</var>) is <emu-val>false</emu-val>, throw a <emu-val>TypeError</emu-val> exception.</li><li>Else,<ol><li>Let <var>protoParent</var> be ? <emu-xref aoid="Get"><a href="https://tc39.github.io/ecma262/#sec-get-o-p">Get</a></emu-xref>(<var>superclass</var>, <code>"prototype"</code>).</li><li>If <emu-xref aoid="Type"><a href="https://tc39.github.io/ecma262/#sec-ecmascript-data-types-and-values">Type</a></emu-xref>(<var>protoParent</var>) is neither Object nor Null, throw a <emu-val>TypeError</emu-val> exception.</li><li>Let <var>constructorParent</var> be <var>superclass</var>.</li></ol></li></ol></li><li>Let <var>proto</var> be <emu-xref aoid="ObjectCreate"><a href="https://tc39.github.io/ecma262/#sec-objectcreate">ObjectCreate</a></emu-xref>(<var>protoParent</var>).</li><li>If <emu-nt optional=""><a href="https://tc39.github.io/ecma262/#prod-ClassBody">ClassBody</a><emu-mods><emu-opt>opt</emu-opt></emu-mods></emu-nt> is not present, let <var>constructor</var> be <emu-const>empty</emu-const>.</li><li>Else, let <var>constructor</var> be ConstructorMethod of <emu-nt><a href="https://tc39.github.io/ecma262/#prod-ClassBody">ClassBody</a></emu-nt>.</li><li>If <var>constructor</var> is <emu-const>empty</emu-const>, then<ol><li>If <emu-nt optional=""><a href="https://tc39.github.io/ecma262/#prod-ClassHeritage">ClassHeritage</a><emu-mods><emu-opt>opt</emu-opt></emu-mods></emu-nt> is present and <var>protoParent</var> is not <emu-val>null</emu-val>, then<ol><li>Let <var>constructor</var> be the result of parsing the source text
              <pre><code class="javascript hljs"><span class="hljs-keyword">constructor</span>(... args){ <span class="hljs-keyword">super</span> (...args);}</code></pre>
              using the syntactic grammar with the goal symbol <emu-nt params="~Yield"><a href="#prod-MethodDefinition">MethodDefinition</a><emu-mods><emu-params>[~Yield]</emu-params></emu-mods></emu-nt>.</li></ol></li><li>Else,<ol><li>Let <var>constructor</var> be the result of parsing the source text
              <pre><code class="javascript hljs"><span class="hljs-keyword">constructor</span>( ){ }</code></pre>
              using the syntactic grammar with the goal symbol <emu-nt params="~Yield"><a href="#prod-MethodDefinition">MethodDefinition</a><emu-mods><emu-params>[~Yield]</emu-params></emu-mods></emu-nt>.</li></ol></li></ol></li><li>Set the <emu-xref href="#running-execution-context"><a href="https://tc39.github.io/ecma262/#running-execution-context">running execution context</a></emu-xref>'s LexicalEnvironment to <var>classScope</var>.</li><li><del>Let <var>constructorInfo</var> be the result of performing DefineMethod for <var>constructor</var> with arguments <var>proto</var> and <var>constructorParent</var> as the optional <var>functionPrototype</var> argument.</del></li><li><del>Assert: <var>constructorInfo</var> is not an <emu-xref href="#sec-completion-record-specification-type"><a href="https://tc39.github.io/ecma262/#sec-completion-record-specification-type">abrupt completion</a></emu-xref>.</del></li><li><del>Let <var>F</var> be <var>constructorInfo</var>.[[Closure]].</del></li><li><del>If <emu-nt optional=""><a href="https://tc39.github.io/ecma262/#prod-ClassHeritage">ClassHeritage</a><emu-mods><emu-opt>opt</emu-opt></emu-mods></emu-nt> is present and <var>protoParent</var> is not <emu-val>null</emu-val>, then set <var>F</var>.[[ConstructorKind]] to <code>"derived"</code>.</del></li><li><del>Perform <emu-xref aoid="MakeConstructor"><a href="https://tc39.github.io/ecma262/#sec-makeconstructor">MakeConstructor</a></emu-xref>(<var>F</var>, <emu-val>false</emu-val>, <var>proto</var>).</del></li><li><del>Perform <emu-xref aoid="MakeClassConstructor"><a href="https://tc39.github.io/ecma262/#sec-makeclassconstructor">MakeClassConstructor</a></emu-xref>(<var>F</var>).</del></li><li><del>Perform <emu-xref aoid="CreateMethodProperty"><a href="https://tc39.github.io/ecma262/#sec-createmethodproperty">CreateMethodProperty</a></emu-xref>(<var>proto</var>, <code>"constructor"</code>, <var>F</var>).</del></li><li>If <emu-nt optional=""><a href="https://tc39.github.io/ecma262/#prod-ClassBody">ClassBody</a><emu-mods><emu-opt>opt</emu-opt></emu-mods></emu-nt> is not present, let <var>methods</var> be a new empty <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.github.io/ecma262/#sec-list-and-record-specification-type">List</a></emu-xref>.</li><li>Else, let <var>methods</var> be NonConstructorMethodDefinitions of <emu-nt><a href="https://tc39.github.io/ecma262/#prod-ClassBody">ClassBody</a></emu-nt>.</li><li>For each <emu-nt><a href="#prod-ClassElement">ClassElement</a></emu-nt> <var>m</var> in order from <var>methods</var><ol><li><del>If IsStatic of <var>m</var> is <emu-val>false</emu-val>, then</del><ol><li><del>Let <var>status</var> be the result of performing PropertyDefinitionEvaluation for <var>m</var> with arguments <var>proto</var> and <emu-val>false</emu-val>.</del></li></ol></li><li><del>Else,</del><ol><li><del>Let <var>status</var> be the result of performing PropertyDefinitionEvaluation for <var>m</var> with arguments <var>F</var> and <emu-val>false</emu-val>.</del></li></ol></li><li><del>If <var>status</var> is an <emu-xref href="#sec-completion-record-specification-type"><a href="https://tc39.github.io/ecma262/#sec-completion-record-specification-type">abrupt completion</a></emu-xref>, then</del></li><li><del>Set the <emu-xref href="#running-execution-context"><a href="https://tc39.github.io/ecma262/#running-execution-context">running execution context</a></emu-xref>'s LexicalEnvironment to <var>lex</var>.</del></li><li><del>Return <emu-xref aoid="Completion"><a href="https://tc39.github.io/ecma262/#sec-completion-record-specification-type">Completion</a></emu-xref>(<var>status</var>).</del></li><li><ins>Let <var>static</var> be IsStatic of <var>m</var>.</ins></li><li><ins>If <var>m</var>'s <emu-nt><a href="#prod-DecoratorList">DecoratorList</a></emu-nt> is present, then let <var>decorators</var> be the result of performing DecoratorListEvaluation of <emu-nt><a href="#prod-DecoratorList">DecoratorList</a></emu-nt>.</ins></li><li><ins>Else, let <var>decorators</var> be a new empty <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.github.io/ecma262/#sec-list-and-record-specification-type">List</a></emu-xref>.</ins></li><li><ins><emu-xref aoid="ReturnIfAbrupt"><a href="https://tc39.github.io/ecma262/#sec-returnifabrupt">ReturnIfAbrupt</a></emu-xref>(<var>decorators</var>).</ins></li><li><ins>Let <var>el</var> be the result of performing PropertyDefinitionEvaluation for <var>m</var> with arguments <var>proto</var>, <emu-val>false</emu-val>.</ins></li><li><ins>If <var>el</var> is an <emu-xref href="#sec-completion-record-specification-type"><a href="https://tc39.github.io/ecma262/#sec-completion-record-specification-type">abrupt completion</a></emu-xref>, then</ins><ol><li><ins>Set the <emu-xref href="#running-execution-context"><a href="https://tc39.github.io/ecma262/#running-execution-context">running execution context</a></emu-xref>'s LexicalEnvironment to <var>lex</var>.</ins></li><li><ins>Return <emu-xref aoid="Completion"><a href="https://tc39.github.io/ecma262/#sec-completion-record-specification-type">Completion</a></emu-xref>(<var>el</var>).</ins></li></ol></li><li><ins>Else, let <var>descriptor</var> be <var>descriptor</var>.[[value]].</ins></li><li><ins>Let <var>element</var> be the <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.github.io/ecma262/#sec-list-and-record-specification-type">Record</a></emu-xref>{[[Kind]]: <code>"property"</code>, [[Static]]: <var>static</var>, [[Key]]: <var>descriptor</var>.[[Key]], [[Descriptor]]: <var>descriptor</var>.[[Descriptor]], [[Decorators]]: <var>decorators</var>}.</ins></li><li><ins>Append <var>element</var> to the end of <var>elements</var>.</ins></li></ol></li><li><ins>Let <var>coalesced</var> be the new <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.github.io/ecma262/#sec-list-and-record-specification-type">List</a></emu-xref> created by combining getters and setters with the same [[Key]]. If both a getter and setter with the same [[Key]] have a non-empty [[Decorators]], throw a new Error.</ins></li><li><ins>Let <var>elementDescriptors</var> be a new empty <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.github.io/ecma262/#sec-list-and-record-specification-type">List</a></emu-xref>.</ins></li><li><ins>For each <var>element</var> in order from <var>coalesced</var></ins><ol><li><ins>Let <var>decorated</var> be ? <emu-xref aoid="DecorateElement"><a href="#sec-decorate-element">DecorateElement</a></emu-xref>(<var>element</var>).</ins></li><li><ins>Append <var>decorated</var>.[[Descriptor]] to the end of <var>elementDescriptors</var>.</ins></li><li><ins>For each <var>descriptor</var> in order from <var>decorated</var>.[[Extras]].</ins><ol><li><ins>Append <var>descriptor</var> to the end of <var>elementDescriptors</var>.</ins></li></ol></li></ol></li><li><ins>Let <var>constructorInfo</var> be the result of performing DefineMethod for <var>constructor</var> with <var>constructorParent</var> as the optional <var>functionPrototype</var> argument.</ins></li><li><ins>Assert: <var>constructorInfo</var> is not an <emu-xref href="#sec-completion-record-specification-type"><a href="https://tc39.github.io/ecma262/#sec-completion-record-specification-type">abrupt completion</a></emu-xref>.</ins></li><li><ins>Let <var>originalF</var> be <var>constructorInfo</var>.[[Closure]].</ins></li><li><ins>Let <var>F</var> be MakeUninitializedConstructor(<var>originalF</var>).</ins></li><li><ins>Let <var>result</var> be ? DecorateClass(<var>F</var>, <var>constructorParent</var>, <var>elementDescriptors</var>).</ins></li><li><ins>Let <var>constructor</var> be <var>result</var>.[[Constructor]].</ins></li><li><ins>Let <var>elements</var> be <var>result</var>.[[Elements]].</ins></li><li><ins>If |ClassHeritage?| is present and <var>protoParent</var> is not <emu-val>null</emu-val>, then set <var>constructor</var>'s [[ConstructorKind]] internal slot to <code>"derived"</code>.</ins></li><li><ins>Perform <emu-xref aoid="MakeConstructor"><a href="https://tc39.github.io/ecma262/#sec-makeconstructor">MakeConstructor</a></emu-xref>(<var>constructor</var>, <emu-val>false</emu-val>, <var>proto</var>).</ins></li><li><ins>Perform <emu-xref aoid="MakeClassConstructor"><a href="https://tc39.github.io/ecma262/#sec-makeclassconstructor">MakeClassConstructor</a></emu-xref>(<var>constructor</var>).</ins></li><li><ins>Perform <emu-xref aoid="CreateMethodProperty"><a href="https://tc39.github.io/ecma262/#sec-createmethodproperty">CreateMethodProperty</a></emu-xref>(<var>proto</var>, <code>"constructor"</code>, <var>constructor</var>).</ins></li><li><ins>For each <var>descriptor</var> in order from <var>elements</var></ins><ol><li><ins>Assert: <var>descriptor</var>.[[Kind]] is <code>"property"</code></ins></li><li><ins>If <var>descriptor</var>.[[Static]] is <emu-val>false</emu-val>, then</ins><ol><li><ins>Let <var>status</var> be <emu-xref aoid="DefinePropertyOrThrow"><a href="https://tc39.github.io/ecma262/#sec-definepropertyorthrow">DefinePropertyOrThrow</a></emu-xref>(<var>proto</var>, <var>descriptor</var>.[[Key]], <var>descriptor</var>.[[Descriptor]])</ins></li></ol></li><li><ins>Else,</ins></li><li><ins>Let <var>status</var> be <emu-xref aoid="DefinePropertyOrThrow"><a href="https://tc39.github.io/ecma262/#sec-definepropertyorthrow">DefinePropertyOrThrow</a></emu-xref>(<var>constructor</var>, <var>descriptor</var>.[[Key]], <var>descriptor</var>.[[Descriptor]])</ins></li><li><ins>If <var>status</var> is an <emu-xref href="#sec-completion-record-specification-type"><a href="https://tc39.github.io/ecma262/#sec-completion-record-specification-type">abrupt completion</a></emu-xref>, then</ins><ol><li><ins>Set the <emu-xref href="#running-execution-context"><a href="https://tc39.github.io/ecma262/#running-execution-context">running execution context</a></emu-xref>'s LexicalEnvironment to <var>lex</var>.</ins></li><li><ins>Return <emu-xref aoid="Completion"><a href="https://tc39.github.io/ecma262/#sec-completion-record-specification-type">Completion</a></emu-xref>(<var>status</var>).</ins></li></ol></li></ol></li><li><ins>Perform MakeFunctionInitialized(<var>constructor</var>).</ins></li><li><ins>Perform MakeClassElementsInitialized(<var>elementDescriptors</var>).</ins></li><li>Set the <emu-xref href="#running-execution-context"><a href="https://tc39.github.io/ecma262/#running-execution-context">running execution context</a></emu-xref>'s LexicalEnvironment to <var>lex</var>.</li><li>If <var>className</var> is not <emu-val>undefined</emu-val>, then<ol><li>Perform <var>classScopeEnvRec</var>.InitializeBinding(<var>className</var>, <del><var>F</var></del><ins><var>constructor</var></ins>).</li></ol></li><li><ins>Let <var>finisher</var> be GetFinisherFromDescriptors(<var>elementDescriptors</var>).</ins></li><li><ins>Call ? <var>finisher</var>(<var>constructor</var>).</ins></li><li>Return <del><var>F</var></del><ins><var>constructor</var></ins>.
      </li></ol></emu-alg>
      <emu-note><span class="note">Note</span>
        <p>We need to make a decision about what validations we need on the <var>extras</var> list, and when to apply it.</p>
        <p>At minimum, if one decorator marks a property as non-configurable, another decorator will not be allowed to modify it.</p>
        <p>There are several options:</p>
        <ul>
          <li>Imperatively apply the extras, and let them naturally merge (or fail in the configurability case).</li>
          <li>Validate the extras as they are produced.</li>
          <li>Validate the entire list of extras right before they are applied.</li>
        </ul>
        <p>We would prefer to avoid the first option, because it is useful for users of decorators to know if they have caused a name conflict.</p>
        <p>Note: The second and third option are observably different in terms of timing.</p>
        <p>In terms of validations, we would prefer to disallow naming conflicts caused by extras, which would otherwise become confusing silent errors.</p>
        <p>We would also prefer to disallow, as a validation rule, a property made non-configurable by one decorator to be modified by a future one
        (rather than causing it to fail at application time).</p>
        <p>It seems important to allow decorators on a single element to be reordered flexibly, so that for example a  <code>@nonconfigurable</code> decorator could be applied before or after an  <code>@enumerable</code> decorator. On the other hand, decorators on separate elements that end up affecting class properties of the same name are almost always going to be bugs (analogous to name collisions arising from unhygienic macros). For both of these reasons, it seems important for a single element's decorators to be combined permissively, whereas the extras produced by distinct elements should be validated not to have conflicts.</p>
      </emu-note>
    </emu-clause>

    <emu-clause id="sec-method-definitions-runtime-semantics-propertydefinitionevaluation">
      <h1><span class="secnum">2.1.3</span>Runtime Semantics: PropertyDefinitionEvaluation<span class="utils"><span class="anchor"><a href="#sec-method-definitions-runtime-semantics-propertydefinitionevaluation">#</a></span></span></h1>
      <p>With parameters <var>object</var> and <var>enumerable</var>.</p>
      <emu-note><span class="note">Note</span><p>The modifications to PropertyDefinitionEvaluation delays actually building the object by returning a record instead of doing the DefineProperty at this point. We also make any closures uninitialized.</p></emu-note>
      <emu-see-also-para op="PropertyDefinitionEvaluation"></emu-see-also-para>
      <emu-grammar><emu-production name="MethodDefinition" collapsed="">
    <emu-nt><a href="#prod-MethodDefinition">MethodDefinition</a></emu-nt><emu-geq>:</emu-geq><emu-rhs a="127f1e91"><emu-nt><a href="https://tc39.github.io/ecma262/#prod-PropertyName">PropertyName</a></emu-nt><emu-t>(</emu-t><emu-nt><a href="https://tc39.github.io/ecma262/#prod-StrictFormalParameters">StrictFormalParameters</a></emu-nt><emu-t>)</emu-t><emu-t>{</emu-t><emu-nt><a href="https://tc39.github.io/ecma262/#prod-FunctionBody">FunctionBody</a></emu-nt><emu-t>}</emu-t></emu-rhs>
</emu-production></emu-grammar>
      <emu-alg><ol><li>Let <var>methodDef</var> be DefineMethod of <emu-nt><a href="#prod-MethodDefinition">MethodDefinition</a></emu-nt> with argument <var>object</var>.</li><li><emu-xref aoid="ReturnIfAbrupt"><a href="https://tc39.github.io/ecma262/#sec-returnifabrupt">ReturnIfAbrupt</a></emu-xref>(<var>methodDef</var>).</li><li>Perform <emu-xref aoid="SetFunctionName"><a href="https://tc39.github.io/ecma262/#sec-setfunctionname">SetFunctionName</a></emu-xref>(<var>methodDef</var>.[[Closure]], <var>methodDef</var>.[[Key]]).</li><li><del>Let <var>desc</var> be the PropertyDescriptor{[[Value]]: <var>methodDef</var>.[[Closure]], [[Writable]]: <emu-val>true</emu-val>, [[Enumerable]]: <var>enumerable</var>, [[Configurable]]: <emu-val>true</emu-val>}.</del></li><li><del>Return ? <emu-xref aoid="DefinePropertyOrThrow"><a href="https://tc39.github.io/ecma262/#sec-definepropertyorthrow">DefinePropertyOrThrow</a></emu-xref>(<var>object</var>, <var>methodDef</var>.[[Key]], <var>desc</var>).</del></li><li><ins>Let <var>closure</var> be MakeFunctionUninitialized(<var>methodDef</var>.[[Closure]]).</ins></li><li><ins>Let <var>desc</var> be the PropertyDescriptor{[[Value]]: <var>closure</var>, [[Writable]]: <emu-val>true</emu-val>, [[Enumerable]]: <var>enumerable</var>, [[Configurable]]: <emu-val>true</emu-val>}.</ins></li><li><ins>Return the <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.github.io/ecma262/#sec-list-and-record-specification-type">Record</a></emu-xref>{[[Key]]: <var>methodDef</var>.[[Key]], [[Desc]]: <var>desc</var>, [[Decorators]]: <var>decorators</var>}.</ins>
      </li></ol></emu-alg>
      <emu-grammar><emu-production name="MethodDefinition" collapsed="">
    <emu-nt><a href="#prod-MethodDefinition">MethodDefinition</a></emu-nt><emu-geq>:</emu-geq><emu-rhs a="f1487956"><emu-t>get</emu-t><emu-nt><a href="https://tc39.github.io/ecma262/#prod-PropertyName">PropertyName</a></emu-nt><emu-t>(</emu-t><emu-t>)</emu-t><emu-t>{</emu-t><emu-nt><a href="https://tc39.github.io/ecma262/#prod-FunctionBody">FunctionBody</a></emu-nt><emu-t>}</emu-t></emu-rhs>
</emu-production></emu-grammar>
      <emu-alg><ol><li>Let <var>propKey</var> be the result of evaluating <emu-nt><a href="https://tc39.github.io/ecma262/#prod-PropertyName">PropertyName</a></emu-nt>.</li><li><emu-xref aoid="ReturnIfAbrupt"><a href="https://tc39.github.io/ecma262/#sec-returnifabrupt">ReturnIfAbrupt</a></emu-xref>(<var>propKey</var>).</li><li>If the function code for this <emu-nt><a href="#prod-MethodDefinition">MethodDefinition</a></emu-nt> is <emu-xref href="#sec-strict-mode-code"><a href="https://tc39.github.io/ecma262/#sec-strict-mode-code">strict mode code</a></emu-xref>, let <var>strict</var> be <emu-val>true</emu-val>. Otherwise let <var>strict</var> be <emu-val>false</emu-val>.</li><li>Let <var>scope</var> be the <emu-xref href="#running-execution-context"><a href="https://tc39.github.io/ecma262/#running-execution-context">running execution context</a></emu-xref>'s LexicalEnvironment.</li><li>Let <var>formalParameterList</var> be the production <emu-grammar><emu-production name="FormalParameters" collapsed="" id="prod-FormalParameters" class=" inline">
    <emu-nt><a href="#prod-FormalParameters">FormalParameters</a></emu-nt><emu-geq>:</emu-geq><emu-rhs a="37b9c04c"><emu-gann>[empty]</emu-gann></emu-rhs>
</emu-production></emu-grammar>.</li><li>Let <var>closure</var> be <emu-xref aoid="FunctionCreate"><a href="https://tc39.github.io/ecma262/#sec-functioncreate">FunctionCreate</a></emu-xref>(<emu-const>Method</emu-const>, <var>formalParameterList</var>, <emu-nt><a href="https://tc39.github.io/ecma262/#prod-FunctionBody">FunctionBody</a></emu-nt>, <var>scope</var>, <var>strict</var>).</li><li><del>Perform <emu-xref aoid="MakeMethod"><a href="https://tc39.github.io/ecma262/#sec-makemethod">MakeMethod</a></emu-xref>(<var>closure</var>, <var>object</var>).</del></li><li>Perform <emu-xref aoid="SetFunctionName"><a href="https://tc39.github.io/ecma262/#sec-setfunctionname">SetFunctionName</a></emu-xref>(<var>closure</var>, <var>propKey</var>, <code>"get"</code>).</li><li><ins>Let <var>closure</var> be MakeFunctionUninitialized(<var>closure</var>).</ins></li><li>Let <var>desc</var> be the PropertyDescriptor{[[Get]]: <var>closure</var>, [[Enumerable]]: <var>enumerable</var>, [[Configurable]]: <emu-val>true</emu-val>}.</li><li><del>Return ? <emu-xref aoid="DefinePropertyOrThrow"><a href="https://tc39.github.io/ecma262/#sec-definepropertyorthrow">DefinePropertyOrThrow</a></emu-xref>(<var>object</var>, <var>propKey</var>, <var>desc</var>).</del></li><li><ins>Return the <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.github.io/ecma262/#sec-list-and-record-specification-type">Record</a></emu-xref>{[[Key]]: <var>propKey</var>, [[Desc]]: <var>desc</var>}.</ins>
      </li></ol></emu-alg>
      <emu-grammar><emu-production name="MethodDefinition" collapsed="">
    <emu-nt><a href="#prod-MethodDefinition">MethodDefinition</a></emu-nt><emu-geq>:</emu-geq><emu-rhs a="4402354c"><emu-t>set</emu-t><emu-nt><a href="https://tc39.github.io/ecma262/#prod-PropertyName">PropertyName</a></emu-nt><emu-t>(</emu-t><emu-nt><a href="https://tc39.github.io/ecma262/#prod-PropertySetParameterList">PropertySetParameterList</a></emu-nt><emu-t>)</emu-t><emu-t>{</emu-t><emu-nt><a href="https://tc39.github.io/ecma262/#prod-FunctionBody">FunctionBody</a></emu-nt><emu-t>}</emu-t></emu-rhs>
</emu-production></emu-grammar>
      <emu-alg><ol><li>Let <var>propKey</var> be the result of evaluating <emu-nt><a href="https://tc39.github.io/ecma262/#prod-PropertyName">PropertyName</a></emu-nt>.</li><li><emu-xref aoid="ReturnIfAbrupt"><a href="https://tc39.github.io/ecma262/#sec-returnifabrupt">ReturnIfAbrupt</a></emu-xref>(<var>propKey</var>).</li><li>If the function code for this <emu-nt><a href="#prod-MethodDefinition">MethodDefinition</a></emu-nt> is <emu-xref href="#sec-strict-mode-code"><a href="https://tc39.github.io/ecma262/#sec-strict-mode-code">strict mode code</a></emu-xref>, let <var>strict</var> be <emu-val>true</emu-val>. Otherwise let <var>strict</var> be <emu-val>false</emu-val>.</li><li>Let <var>scope</var> be the <emu-xref href="#running-execution-context"><a href="https://tc39.github.io/ecma262/#running-execution-context">running execution context</a></emu-xref>'s LexicalEnvironment.</li><li>Let <var>closure</var> be <emu-xref aoid="FunctionCreate"><a href="https://tc39.github.io/ecma262/#sec-functioncreate">FunctionCreate</a></emu-xref>(<emu-const>Method</emu-const>, <emu-nt><a href="https://tc39.github.io/ecma262/#prod-PropertySetParameterList">PropertySetParameterList</a></emu-nt>, <emu-nt><a href="https://tc39.github.io/ecma262/#prod-FunctionBody">FunctionBody</a></emu-nt>, <var>scope</var>, <var>strict</var>).</li><li><del>Perform <emu-xref aoid="MakeMethod"><a href="https://tc39.github.io/ecma262/#sec-makemethod">MakeMethod</a></emu-xref>(<var>closure</var>, <var>object</var>).</del></li><li>Perform <emu-xref aoid="SetFunctionName"><a href="https://tc39.github.io/ecma262/#sec-setfunctionname">SetFunctionName</a></emu-xref>(<var>closure</var>, <var>propKey</var>, <code>"set"</code>).</li><li><ins>Let <var>closure</var> be MakeFunctionUninitialized(<var>closure</var>).</ins></li><li>Let <var>desc</var> be the PropertyDescriptor{[[Set]]: <var>closure</var>, [[Enumerable]]: <var>enumerable</var>, [[Configurable]]: <emu-val>true</emu-val>}.</li><li><del>Return ? <emu-xref aoid="DefinePropertyOrThrow"><a href="https://tc39.github.io/ecma262/#sec-definepropertyorthrow">DefinePropertyOrThrow</a></emu-xref>(<var>object</var>, <var>propKey</var>, <var>desc</var>).</del></li><li><ins>Return the <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.github.io/ecma262/#sec-list-and-record-specification-type">Record</a></emu-xref>{[[Key]]: <var>propKey</var>, [[Desc]]: <var>desc</var>}.</ins>
      </li></ol></emu-alg>
      <emu-grammar><emu-production name="GeneratorMethod" collapsed="" id="prod-GeneratorMethod">
    <emu-nt><a href="#prod-GeneratorMethod">GeneratorMethod</a></emu-nt><emu-geq>:</emu-geq><emu-rhs a="3977072d"><emu-t>*</emu-t><emu-nt><a href="https://tc39.github.io/ecma262/#prod-PropertyName">PropertyName</a></emu-nt><emu-t>(</emu-t><emu-nt><a href="https://tc39.github.io/ecma262/#prod-StrictFormalParameters">StrictFormalParameters</a></emu-nt><emu-t>)</emu-t><emu-t>{</emu-t><emu-nt><a href="https://tc39.github.io/ecma262/#prod-GeneratorBody">GeneratorBody</a></emu-nt><emu-t>}</emu-t></emu-rhs>
</emu-production></emu-grammar>
      <emu-alg><ol><li>Let <var>propKey</var> be the result of evaluating <emu-nt><a href="https://tc39.github.io/ecma262/#prod-PropertyName">PropertyName</a></emu-nt>.</li><li><emu-xref aoid="ReturnIfAbrupt"><a href="https://tc39.github.io/ecma262/#sec-returnifabrupt">ReturnIfAbrupt</a></emu-xref>(<var>propKey</var>).</li><li>If the function code for this <emu-nt><a href="#prod-GeneratorMethod">GeneratorMethod</a></emu-nt> is <emu-xref href="#sec-strict-mode-code"><a href="https://tc39.github.io/ecma262/#sec-strict-mode-code">strict mode code</a></emu-xref>, let <var>strict</var> be <emu-val>true</emu-val>. Otherwise let <var>strict</var> be <emu-val>false</emu-val>.</li><li>Let <var>scope</var> be the <emu-xref href="#running-execution-context"><a href="https://tc39.github.io/ecma262/#running-execution-context">running execution context</a></emu-xref>'s LexicalEnvironment.</li><li>Let <var>closure</var> be <emu-xref aoid="GeneratorFunctionCreate"><a href="https://tc39.github.io/ecma262/#sec-generatorfunctioncreate">GeneratorFunctionCreate</a></emu-xref>(<emu-const>Method</emu-const>, <emu-nt><a href="https://tc39.github.io/ecma262/#prod-StrictFormalParameters">StrictFormalParameters</a></emu-nt>, <emu-nt><a href="https://tc39.github.io/ecma262/#prod-GeneratorBody">GeneratorBody</a></emu-nt>, <var>scope</var>, <var>strict</var>).</li><li><del>Perform <emu-xref aoid="MakeMethod"><a href="https://tc39.github.io/ecma262/#sec-makemethod">MakeMethod</a></emu-xref>(<var>closure</var>, <var>object</var>).</del></li><li>Let <var>prototype</var> be <emu-xref aoid="ObjectCreate"><a href="https://tc39.github.io/ecma262/#sec-objectcreate">ObjectCreate</a></emu-xref>(<emu-xref href="#sec-properties-of-generator-prototype"><a href="https://tc39.github.io/ecma262/#sec-properties-of-generator-prototype">%GeneratorPrototype%</a></emu-xref>).</li><li>Perform <emu-xref aoid="DefinePropertyOrThrow"><a href="https://tc39.github.io/ecma262/#sec-definepropertyorthrow">DefinePropertyOrThrow</a></emu-xref>(<var>closure</var>, <code>"prototype"</code>, PropertyDescriptor{[[Value]]: <var>prototype</var>, [[Writable]]: <emu-val>true</emu-val>, [[Enumerable]]: <emu-val>false</emu-val>, [[Configurable]]: <emu-val>false</emu-val>}).</li><li>Perform <emu-xref aoid="SetFunctionName"><a href="https://tc39.github.io/ecma262/#sec-setfunctionname">SetFunctionName</a></emu-xref>(<var>closure</var>, <var>propKey</var>).</li><li><ins>Let <var>closure</var> be MakeFunctionUninitialized(<var>closure</var>).</ins></li><li>Let <var>desc</var> be the PropertyDescriptor{[[Value]]: <var>closure</var>, [[Writable]]: <emu-val>true</emu-val>, [[Enumerable]]: <var>enumerable</var>, [[Configurable]]: <emu-val>true</emu-val>}.</li><li><del>Return ? <emu-xref aoid="DefinePropertyOrThrow"><a href="https://tc39.github.io/ecma262/#sec-definepropertyorthrow">DefinePropertyOrThrow</a></emu-xref>(<var>object</var>, <var>propKey</var>, <var>desc</var>).</del></li><li><ins>Return the <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.github.io/ecma262/#sec-list-and-record-specification-type">Record</a></emu-xref>{[[Key]]: <var>propKey</var>, [[Desc]]: <var>desc</var>}.</ins>
      </li></ol></emu-alg>
    </emu-clause>
  </emu-clause>

  <emu-clause id="sec-new-semantics">
    <h1><span class="secnum">2.2</span>New Operations<span class="utils"><span class="anchor"><a href="#sec-new-semantics">#</a></span></span></h1>
    <emu-clause id="sec-decorator-runtime-semantics-decoratorevaluation">
      <h1><span class="secnum">2.2.1</span>Runtime Semantics: DecoratorEvaluation<span class="utils"><span class="anchor"><a href="#sec-decorator-runtime-semantics-decoratorevaluation">#</a></span></span></h1>
      <emu-grammar><emu-production name="Decorator" collapsed="">
    <emu-nt><a href="#prod-Decorator">Decorator</a></emu-nt><emu-geq>:</emu-geq><emu-rhs a="16b21563"><emu-t>@</emu-t><emu-nt params="?Yield"><a href="#prod-DecoratorMemberExpression">DecoratorMemberExpression</a><emu-mods><emu-params>[?Yield]</emu-params></emu-mods></emu-nt></emu-rhs>
</emu-production></emu-grammar>
      <emu-alg><ol><li>Let _ref be the result of evaluating <emu-nt><a href="#prod-DecoratorMemberExpression">DecoratorMemberExpression</a></emu-nt>.</li><li>Let _value be ? <emu-xref aoid="GetValue"><a href="https://tc39.github.io/ecma262/#sec-getvalue">GetValue</a></emu-xref>(<var>ref</var>).</li><li>Return <var>value</var>.
      </li></ol></emu-alg>
      <emu-grammar><emu-production name="Decorator" collapsed="">
    <emu-nt><a href="#prod-Decorator">Decorator</a></emu-nt><emu-geq>:</emu-geq><emu-rhs a="c70b83ce"><emu-t>@</emu-t><emu-nt params="?Yield"><a href="#prod-DecoratorCallExpression">DecoratorCallExpression</a><emu-mods><emu-params>[?Yield]</emu-params></emu-mods></emu-nt></emu-rhs>
</emu-production></emu-grammar>
      <emu-alg><ol><li>Let _ref be the result of evaluating <emu-nt><a href="#prod-DecoratorCallExpression">DecoratorCallExpression</a></emu-nt>.</li><li>Let _value be ? <emu-xref aoid="GetValue"><a href="https://tc39.github.io/ecma262/#sec-getvalue">GetValue</a></emu-xref>(<var>ref</var>).</li><li>Return <var>value</var>.
      </li></ol></emu-alg>
    </emu-clause>

    <emu-clause id="sec-method-definitions-runtime-semantics-decoratorlistevaluation">
      <h1><span class="secnum">2.2.2</span>Runtime Semantics: DecoratorListEvaluation<span class="utils"><span class="anchor"><a href="#sec-method-definitions-runtime-semantics-decoratorlistevaluation">#</a></span></span></h1>
      <emu-grammar><emu-production name="DecoratorList" collapsed="">
    <emu-nt><a href="#prod-DecoratorList">DecoratorList</a></emu-nt><emu-geq>:</emu-geq><emu-rhs a="1bdc63ed"><emu-nt params="?Yield" optional=""><a href="#prod-DecoratorList">DecoratorList</a><emu-mods><emu-params>[?Yield]</emu-params><emu-opt>opt</emu-opt></emu-mods></emu-nt><emu-nt params="?Yield"><a href="#prod-Decorator">Decorator</a><emu-mods><emu-params>[?Yield]</emu-params></emu-mods></emu-nt></emu-rhs>
</emu-production></emu-grammar>
      <emu-alg><ol><li>If <emu-nt><a href="#prod-DecoratorList">DecoratorList</a></emu-nt> is present, then let <var>leftValue</var> be ? DecoratorListEvaluation(<emu-nt><a href="#prod-DecoratorList">DecoratorList</a></emu-nt>).</li><li>Else, let <var>leftValue</var> be a new empty <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.github.io/ecma262/#sec-list-and-record-specification-type">List</a></emu-xref>.</li><li>Let <var>rightValue</var> be ? DecoratorEvaluation(<emu-nt><a href="#prod-Decorator">Decorator</a></emu-nt>).</li><li>Append <var>rightValue</var> to the end of <var>leftValue</var>.</li><li>Return <var>leftValue</var>.
      </li></ol></emu-alg>
    </emu-clause>

    <emu-clause id="sec-runtime-semantics-makefunctionuninitialized">
      <h1><span class="secnum">2.2.3</span>Runtime Semantics: MakeFunctionUninitialized<span class="utils"><span class="anchor"><a href="#sec-runtime-semantics-makefunctionuninitialized">#</a></span></span></h1>
      <p>With parameter <var>function</var>.</p>
      <emu-note><span class="note">Note</span>
        <p>The semantics of functions leaked to JavaScript during decoration was contentious in Munich. The exact semantics will be driven by implementation considerations.</p>
      </emu-note>
    </emu-clause>

    <emu-clause id="sec-runtime-semantics-makefunctioninitialized">
      <h1><span class="secnum">2.2.4</span>Runtime Semantics: MakeFunctionInitialized<span class="utils"><span class="anchor"><a href="#sec-runtime-semantics-makefunctioninitialized">#</a></span></span></h1>
      <p>With parameter <var>function</var>.</p>
      <emu-note><span class="note">Note</span>
        <p>The semantics of functions leaked to JavaScript during decoration was contentious in Munich. The exact semantics will be driven by implementation considerations.</p>
      </emu-note>
    </emu-clause>

    <emu-clause id="sec-runtime-semantics-makefunctioninitialized">
      <h1><span class="secnum">2.2.5</span>Runtime Semantics: IsUninitializedFunction<span class="utils"><span class="anchor"><a href="#sec-runtime-semantics-makefunctioninitialized">#</a></span></span></h1>
      <p>With parameter <var>function</var>.</p>
      <emu-note><span class="note">Note</span>
        <p>The semantics of functions leaked to JavaScript during decoration was contentious in Munich. The exact semantics will be driven by implementation considerations.</p>
      </emu-note>
    </emu-clause>

    <emu-clause id="sec-runtime-semantics-makeclasselementsinitialized">
      <h1><span class="secnum">2.2.6</span>Runtime Semantics: MakeClassElementsInitialized<span class="utils"><span class="anchor"><a href="#sec-runtime-semantics-makeclasselementsinitialized">#</a></span></span></h1>
      <p>With parameter <var>elements</var>.</p>
      <emu-alg><ol><li>For each <var>element</var> in order from <var>elements</var><ol><li>Let <var>desc</var> be <var>element</var>.[[Descriptor]].</li><li>If <var>desc</var> has a [[Set]] field, MakeFunctionInitialized(<var>desc</var>.[[Set]]).</li><li>If <var>desc</var> has a [[Get]] field, MakeFunctionInitialized(<var>desc</var>.[[Get]]).</li><li>If <var>desc</var> has a [[Value]] field, and IsUninitializedFunction(<var>desc</var>.[[Value]]) is <emu-val>true</emu-val>, MakeFunctionInitialized(<var>desc</var>.[[Value]]).
      </li></ol></li></ol></emu-alg>
      <emu-note><span class="note">Note</span>
        <p>The semantics of functions leaked to JavaScript during decoration was contentious in Munich. The exact semantics will be driven by implementation considerations.</p>
      </emu-note>
    </emu-clause>
    <emu-clause id="sec-decorate-element" aoid="DecorateElement">
      <h1><span class="secnum">2.2.7</span>DecorateElement<span class="utils"><span class="anchor"><a href="#sec-decorate-element">#</a></span></span></h1>
      <p>With parameter <var>element</var>.</p>
      <emu-alg><ol><li>Assert: <var>element</var>.[[Kind]] is <code>"property"</code>.</li><li>Let <var>extras</var> be a new empty <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.github.io/ecma262/#sec-list-and-record-specification-type">List</a></emu-xref>.</li><li>Let <var>previousDescriptor</var> be ? FromElementDescriptor(<var>element</var>).</li><li>For each <var>decorator</var> in element_.[[Decorators]], in reverse list order do<ol><li>Let <var>result</var> be ? <emu-xref aoid="Call"><a href="https://tc39.github.io/ecma262/#sec-call">Call</a></emu-xref>(<var>decorator</var>, <emu-val>undefined</emu-val>, « <var>previousDescriptor</var> »).</li><li>Let <var>currentDescriptor</var> be ? <emu-xref aoid="Get"><a href="https://tc39.github.io/ecma262/#sec-get-o-p">Get</a></emu-xref>(<var>result</var>, <code>"descriptor"</code>).</li><li>Let <var>current</var> be ? ToElementDescriptor(<var>currentDescriptor</var>).</li><li>Let <var>previousDescriptor</var> be ? FromElementDescriptor(<var>current</var>).</li><li>Let <var>extrasObject</var> be ? <emu-xref aoid="Get"><a href="https://tc39.github.io/ecma262/#sec-get-o-p">Get</a></emu-xref>(<var>result</var>, <code>"extras"</code>).</li><li>If <var>extrasObject</var> is not <emu-val>undefined</emu-val>, then:<ol><li>Let <var>iterator</var> be ? <emu-xref aoid="GetIterator"><a href="https://tc39.github.io/ecma262/#sec-getiterator">GetIterator</a></emu-xref>(<var>extrasObject</var>).</li><li>Repeat<ol><li>Let <var>next</var> be ? <emu-xref aoid="IteratorStep"><a href="https://tc39.github.io/ecma262/#sec-iteratorstep">IteratorStep</a></emu-xref>(<var>iterator</var>).</li><li>If <var>next</var> is <emu-val>false</emu-val>, then break.</li><li>Let <var>nextValue</var> be ? <emu-xref aoid="IteratorValue"><a href="https://tc39.github.io/ecma262/#sec-iteratorvalue">IteratorValue</a></emu-xref>(<var>next</var>).</li><li>Append <var>nextValue</var> to the end of <var>extras</var>.</li></ol></li></ol></li></ol></li><li>Let <var>extras</var> be the result of merging any <var>extras</var> with the same [[Key]] and [[Static]].</li><li>Return the <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.github.io/ecma262/#sec-list-and-record-specification-type">Record</a></emu-xref> {[[Descriptor]]: <var>previousDescriptor</var>, [[Extras]]: <var>extras</var>}.
      </li></ol></emu-alg>
      <emu-note><span class="note">Note 1</span>
        <p>Future versions of the spec will create element descriptors with other [[Kind]]s.</p>
      </emu-note>
      <emu-note><span class="note">Note 2</span>
        <p>There is a decision-point about what validation rules should be applied to the merging that happens right before merging.</p>
      </emu-note>
    </emu-clause>
    <emu-clause id="sec-decorate-class">
      <h1><span class="secnum">2.2.8</span>DecorateClass<span class="utils"><span class="anchor"><a href="#sec-decorate-class">#</a></span></span></h1>
      <p>With parameters <var>decorators</var>, <var>constructor</var>, <var>heritage</var> and <var>elementDescriptors</var>.</p>
      <emu-alg><ol><li>Let <var>elements</var> be a new empty <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.github.io/ecma262/#sec-list-and-record-specification-type">List</a></emu-xref>.</li><li>Let <var>previousConstructor</var> be <var>constructor</var>.</li><li>Let <var>previousDescriptors</var> be <var>elementDescriptors</var>.</li><li>For each <var>decorator</var> in <var>decorators</var>, in reverse list order do<ol><li>Let <var>result</var> be ? <emu-xref aoid="Call"><a href="https://tc39.github.io/ecma262/#sec-call">Call</a></emu-xref>(<var>decorator</var>, <emu-val>undefined</emu-val>, « <var>previousConstructor</var>, <var>heritage</var>, <var>previousDescriptors</var> »).</li><li>Let <var>previousConstructor</var> be ? <emu-xref aoid="Get"><a href="https://tc39.github.io/ecma262/#sec-get-o-p">Get</a></emu-xref>(<var>result</var>, <code>"constructor"</code>).</li><li>Let <var>elementsObject</var> be ? <emu-xref aoid="Get"><a href="https://tc39.github.io/ecma262/#sec-get-o-p">Get</a></emu-xref>(<var>result</var>, <code>"elements"</code>).</li><li>If <var>elementsObject</var> is not <emu-val>undefined</emu-val>, then<ol><li>Let <var>iterator</var> be ? <emu-xref aoid="GetIterator"><a href="https://tc39.github.io/ecma262/#sec-getiterator">GetIterator</a></emu-xref>(<var>extrasObject</var>).</li><li>Repeat<ol><li>Let <var>next</var> be ? <emu-xref aoid="IteratorStep"><a href="https://tc39.github.io/ecma262/#sec-iteratorstep">IteratorStep</a></emu-xref>(<var>iterator</var>).</li><li>If <var>next</var> is <emu-val>false</emu-val>, then break.</li><li>Let <var>nextValue</var> be ? <emu-xref aoid="IteratorValue"><a href="https://tc39.github.io/ecma262/#sec-iteratorvalue">IteratorValue</a></emu-xref>(<var>next</var>).</li><li>Append <var>nextValue</var> to the end of <var>elements</var>.</li></ol></li></ol></li></ol></li><li>Let <var>elements</var> be the result of merging any <var>elements</var> with the same [[Key]] and [[Static]].</li><li>Return the <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.github.io/ecma262/#sec-list-and-record-specification-type">Record</a></emu-xref> {[[Constructor]]: <var>previousConstructor</var>, [[Elements]]: <var>elements</var>}.
      </li></ol></emu-alg>
      <emu-note><span class="note">Note</span>
        <p>There is a decision-point about what validation rules should be applied to the merging.</p>
        <p>We also need to decide whether to produce an error if the returned constructor from a decorator has the wrong prototype. We think it
        should be an error.</p>
      </emu-note>
    </emu-clause>

    <emu-clause id="sec-from-element-descriptor">
      <h1><span class="secnum">2.2.9</span>FromElementDescriptor<span class="utils"><span class="anchor"><a href="#sec-from-element-descriptor">#</a></span></span></h1>
      <p>With parameter <var>element</var>.</p>
      <emu-alg><ol><li>Let <var>obj</var> be ! <emu-xref aoid="ObjectCreate"><a href="https://tc39.github.io/ecma262/#sec-objectcreate">ObjectCreate</a></emu-xref>(<emu-xref href="#sec-properties-of-the-object-prototype-object"><a href="https://tc39.github.io/ecma262/#sec-properties-of-the-object-prototype-object">%ObjectPrototype%</a></emu-xref>).</li><li>Perform ! <emu-xref aoid="CreateDataPropertyOrThrow"><a href="https://tc39.github.io/ecma262/#sec-createdatapropertyorthrow">CreateDataPropertyOrThrow</a></emu-xref>(<var>obj</var>, <code>"kind"</code>, <var>element</var>.[[Kind]]).</li><li>Perform ! <emu-xref aoid="CreateDataPropertyOrThrow"><a href="https://tc39.github.io/ecma262/#sec-createdatapropertyorthrow">CreateDataPropertyOrThrow</a></emu-xref>(<var>obj</var>, <code>"isStatic"</code>, <var>element</var>.[[Static]]).</li><li>Perform ! <emu-xref aoid="CreateDataPropertyOrThrow"><a href="https://tc39.github.io/ecma262/#sec-createdatapropertyorthrow">CreateDataPropertyOrThrow</a></emu-xref>(<var>obj</var>, <code>"key"</code>, <var>element</var>.[[Key]]).</li><li>Perform ! <emu-xref aoid="CreateDataPropertyOrThrow"><a href="https://tc39.github.io/ecma262/#sec-createdatapropertyorthrow">CreateDataPropertyOrThrow</a></emu-xref>(<var>obj</var>, <code>"descriptor"</code>, ! <emu-xref aoid="FromPropertyDescriptor"><a href="https://tc39.github.io/ecma262/#sec-frompropertydescriptor">FromPropertyDescriptor</a></emu-xref>(<var>element</var>.[[Descriptor]])).</li><li>Return <var>obj</var>.
      </li></ol></emu-alg>
    </emu-clause>

    <emu-clause id="sec-to-element-descriptor">
      <h1><span class="secnum">2.2.10</span>ToElementDescriptor<span class="utils"><span class="anchor"><a href="#sec-to-element-descriptor">#</a></span></span></h1>
      <p>With parameter <var>descriptor</var>.</p>
      <emu-alg><ol><li>Let <var>kind</var> be ? <emu-xref aoid="Get"><a href="https://tc39.github.io/ecma262/#sec-get-o-p">Get</a></emu-xref>(<var>descriptor</var>, <code>"kind"</code>).</li><li>If <var>kind</var> is not equal to the string value <code>"property"</code>, throw a TypeError exception.</li><li>Let <var>static</var> be <emu-xref aoid="ToBoolean"><a href="https://tc39.github.io/ecma262/#sec-toboolean">ToBoolean</a></emu-xref>(? <emu-xref aoid="Get"><a href="https://tc39.github.io/ecma262/#sec-get-o-p">Get</a></emu-xref>(<var>descriptor</var>, <code>"isStatic"</code>)).</li><li>Let <var>key</var> be ? <emu-xref aoid="ToString"><a href="https://tc39.github.io/ecma262/#sec-tostring">ToString</a></emu-xref>(? <emu-xref aoid="Get"><a href="https://tc39.github.io/ecma262/#sec-get-o-p">Get</a></emu-xref>(<var>descriptor</var>, <code>"key"</code>)).</li><li>Let <var>descriptor</var> be ? <emu-xref aoid="ToPropertyDescriptor"><a href="https://tc39.github.io/ecma262/#sec-topropertydescriptor">ToPropertyDescriptor</a></emu-xref>(? <emu-xref aoid="Get"><a href="https://tc39.github.io/ecma262/#sec-get-o-p">Get</a></emu-xref>(<var>descriptor</var>, <code>"descriptor"</code>)).</li><li>Return the <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.github.io/ecma262/#sec-list-and-record-specification-type">Record</a></emu-xref> {[[Kind]]: <var>kind</var>, [[Static]]: <var>static</var>, [[Key]]: <var>key</var>, [[Descriptor]]: <var>descriptor</var>}.
      </li></ol></emu-alg>
    </emu-clause>

  </emu-clause>
</emu-clause><emu-annex id="sec-copyright-and-software-license">
      <h1><span class="secnum">A</span>Copyright &amp; Software License<span class="utils"><span class="anchor"><a href="#sec-copyright-and-software-license">#</a></span></span></h1>
      
      <h2>Copyright Notice</h2>
      <p>© 2016 Yehuda Katz, Brian Terlson, Ecma International</p>

      <h2>Software License</h2>
      <p>All Software contained in this document ("Software") is protected by copyright and is being made available under the "BSD License", included below. This Software may be subject to third party rights (rights from parties other than Ecma International), including patent rights, and no licenses under such third party rights are granted under this license even if the third party concerned is a member of Ecma International. SEE THE ECMA CODE OF CONDUCT IN PATENT MATTERS AVAILABLE AT http://www.ecma-international.org/memento/codeofconduct.htm FOR INFORMATION REGARDING THE LICENSING OF PATENT CLAIMS THAT ARE REQUIRED TO IMPLEMENT ECMA INTERNATIONAL STANDARDS.</p>

<p>Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</p>

<ol>
  <li>Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</li>
  <li>Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</li>
  <li>Neither the name of the authors nor Ecma International may be used to endorse or promote products derived from this software without specific prior written permission.</li>
</ol>

<p>THIS SOFTWARE IS PROVIDED BY THE ECMA INTERNATIONAL "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL ECMA INTERNATIONAL BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</p>

    </emu-annex>
</body>